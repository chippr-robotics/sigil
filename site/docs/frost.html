<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FROST Multi-Chain Guide | Sigil Documentation</title>
    <meta name="description" content="Quick start guides for Bitcoin Taproot, Solana, Cosmos, and Zcash threshold signatures with FROST.">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="../css/styles.css">
    <link rel="stylesheet" href="../css/docs.css">
    <link rel="icon" type="image/svg+xml" href="../assets/favicon.svg">
</head>
<body>
    <!-- Navigation -->
    <nav class="navbar">
        <div class="container nav-container">
            <a href="../" class="logo">
                <img src="https://github.com/user-attachments/assets/be1db973-ef19-4942-9bab-23c30307ce70" alt="Sigil" class="logo-img">
                <span class="logo-text">Sigil</span>
            </a>
            <div class="nav-links">
                <a href="../#features">Features</a>
                <a href="../#cryptography">Cryptography</a>
                <a href="../#assets">Supported Assets</a>
                <a href="../#documentation">Documentation</a>
                <a href="https://chipprbots.com" class="btn btn-outline" target="_blank" rel="noopener">ChipprBots</a>
                <a href="https://github.com/chippr-robotics/sigil" class="btn btn-primary" target="_blank" rel="noopener">GitHub</a>
            </div>
            <button class="mobile-menu-btn" aria-label="Toggle menu">
                <span></span>
                <span></span>
                <span></span>
            </button>
        </div>
    </nav>

    <!-- Documentation Content -->
    <main class="docs-main">
        <aside class="docs-sidebar">
            <nav class="docs-nav">
                <h4>Documentation</h4>
                <ul>
                    <li><a href="crypto-spec.html">Cryptographic Specification</a></li>
                    <li><a href="frost.html" class="active">FROST Multi-Chain Guide</a></li>
                    <li><a href="threat-model.html">Threat Model</a></li>
                    <li><a href="recovery.html">Recovery Procedures</a></li>
                    <li><a href="zkvm-proofs.html">zkVM Proofs</a></li>
                    <li><a href="timing-safety.html">Timing Safety</a></li>
                </ul>
                <h4>Quick Start Guides</h4>
                <ul class="toc">
                    <li><a href="#taproot">Bitcoin Taproot</a></li>
                    <li><a href="#solana">Solana (Ed25519)</a></li>
                    <li><a href="#cosmos">Cosmos Ecosystem</a></li>
                    <li><a href="#zcash">Zcash Shielded</a></li>
                    <li><a href="#dkg">Distributed Key Generation</a></li>
                </ul>
            </nav>
        </aside>

        <article class="docs-content">
            <div class="docs-header">
                <div class="docs-breadcrumb">
                    <a href="../">Home</a> / <a href="../#documentation">Documentation</a> / <span>FROST Multi-Chain Guide</span>
                </div>
                <h1>FROST Multi-Chain Threshold Signatures</h1>
                <div class="docs-meta">
                    <span class="version">Version 0.2.0</span>
                    <span class="status">Draft for Review</span>
                    <span class="updated">Last Updated: 2026-01-17</span>
                </div>
            </div>

            <section class="docs-section">
                <h2>Overview</h2>
                <p>FROST (Flexible Round-Optimized Schnorr Threshold) extends Sigil's MPC-secured signing to support multiple blockchain ecosystems beyond Ethereum and legacy Bitcoin. This document describes Sigil's FROST implementation and provides quick start guides for each supported ecosystem.</p>

                <h3>Supported Signature Schemes</h3>
                <table class="docs-table">
                    <thead>
                        <tr>
                            <th>Scheme</th>
                            <th>Curve</th>
                            <th>Use Cases</th>
                            <th>Feature Flag</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>ECDSA</td>
                            <td>secp256k1</td>
                            <td>Ethereum, Bitcoin (legacy), BSC, Polygon</td>
                            <td><code>Default</code></td>
                        </tr>
                        <tr>
                            <td>Taproot/Schnorr</td>
                            <td>secp256k1</td>
                            <td>Bitcoin Taproot (BIP-340)</td>
                            <td><code>taproot</code></td>
                        </tr>
                        <tr>
                            <td>Ed25519</td>
                            <td>Curve25519</td>
                            <td>Solana, Cosmos, Near, Polkadot</td>
                            <td><code>ed25519</code></td>
                        </tr>
                        <tr>
                            <td>Ristretto255</td>
                            <td>Ristretto</td>
                            <td>Zcash (shielded transactions)</td>
                            <td><code>ristretto255</code></td>
                        </tr>
                    </tbody>
                </table>
            </section>

            <section class="docs-section">
                <h2>FROST vs ECDSA</h2>
                <p>FROST uses Schnorr signatures, which have a simpler algebraic structure than ECDSA:</p>

                <div class="code-block">
                    <code>ECDSA:   s = k<sup>-1</sup>(z + rx) mod n    (requires modular inverse)
Schnorr: s = k + ex mod n              (simple addition)</code>
                </div>

                <p>This simplicity enables true threshold signatures without complex MPC protocols.</p>

                <h3>Comparison</h3>
                <table class="docs-table comparison-table">
                    <thead>
                        <tr>
                            <th>Aspect</th>
                            <th>ECDSA Presigs</th>
                            <th>FROST</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>Signature scheme</td>
                            <td>ECDSA</td>
                            <td>Schnorr</td>
                        </tr>
                        <tr>
                            <td>MPC complexity</td>
                            <td>High (modular inverse)</td>
                            <td>Low (linear)</td>
                        </tr>
                        <tr>
                            <td>Signature size</td>
                            <td>64-71 bytes (DER)</td>
                            <td>64 bytes</td>
                        </tr>
                        <tr>
                            <td>Batch verification</td>
                            <td>No</td>
                            <td>Yes (3x faster)</td>
                        </tr>
                        <tr>
                            <td>Adaptor signatures</td>
                            <td>Complex</td>
                            <td>Native</td>
                        </tr>
                        <tr>
                            <td>Supported chains</td>
                            <td>Ethereum, legacy BTC</td>
                            <td>Taproot, Solana, Zcash</td>
                        </tr>
                    </tbody>
                </table>
            </section>

            <section class="docs-section" id="taproot">
                <h2>Bitcoin Taproot (BIP-340)</h2>
                <p>Bitcoin Taproot uses BIP-340 Schnorr signatures with x-only public keys.</p>

                <h3>Key Characteristics</h3>
                <ul>
                    <li>32-byte x-only public keys (no prefix byte)</li>
                    <li>64-byte signatures (R || s)</li>
                    <li>Tagged hashing for domain separation</li>
                    <li>Native SegWit v1 addresses (bc1p...)</li>
                </ul>

                <h3>Creating a Taproot Child Disk</h3>
                <div class="code-block">
                    <code># On mother device (air-gapped)
sigil ceremony create-child \
  --scheme taproot \
  --presigs 1000 \
  --label "btc-taproot-001"

# Outputs:
# - Child disk with 1000 FROST presignatures
# - Agent share file for transfer</code>
                </div>

                <h3>Deriving Taproot Address</h3>
                <div class="code-block">
                    <code>use sigil_frost::taproot::TaprootFrost;
use sigil_frost::FrostKeyGen;

// Generate 2-of-2 key shares
let (cold_share, agent_share, verifying_key) = TaprootFrost::generate_2of2()?;

// Get the x-only public key (32 bytes)
let xonly_pubkey = &verifying_key.data;

// Derive bech32m address
let address = bitcoin::Address::p2tr_tweaked(
    bitcoin::XOnlyPublicKey::from_slice(xonly_pubkey)?,
    bitcoin::Network::Bitcoin,
);
println!("Taproot address: {}", address);  // bc1p...</code>
                </div>

                <h3>Transaction Broadcast</h3>
                <div class="code-block">
                    <code># Sign and broadcast via CLI
sigil sign --disk /dev/sda \
  --scheme taproot \
  --tx-hex "02000000..." \
  --broadcast bitcoin-mainnet</code>
                </div>
            </section>

            <section class="docs-section" id="solana">
                <h2>Solana (Ed25519)</h2>
                <p>Solana uses Ed25519 signatures with base58-encoded addresses.</p>

                <h3>Key Characteristics</h3>
                <ul>
                    <li>32-byte public keys (base58 encoded)</li>
                    <li>64-byte signatures</li>
                    <li>No transaction malleability (deterministic signatures)</li>
                    <li>Program-derived addresses (PDAs) for smart contracts</li>
                </ul>

                <h3>Creating a Solana Child Disk</h3>
                <div class="code-block">
                    <code># On mother device (air-gapped)
sigil ceremony create-child \
  --scheme ed25519 \
  --presigs 5000 \
  --label "solana-wallet-001"</code>
                </div>

                <h3>Deriving Solana Address</h3>
                <div class="code-block">
                    <code>use sigil_frost::ed25519::{Ed25519Frost, solana};
use sigil_frost::FrostKeyGen;

// Generate 2-of-2 key shares
let (cold_share, agent_share, verifying_key) = Ed25519Frost::generate_2of2()?;

// Convert to Solana base58 address
let solana_pubkey = solana::to_solana_pubkey(&verifying_key);
println!("Solana address: {}", solana_pubkey);  // e.g., 7EcD...

// For SPL token accounts, derive ATA
let ata = solana::derive_ata(&solana_pubkey, &token_mint)?;</code>
                </div>

                <h3>Transaction Broadcast</h3>
                <div class="code-block">
                    <code># Sign and broadcast via CLI
sigil sign --disk /dev/sda \
  --scheme ed25519 \
  --tx-base64 "AQAAAA..." \
  --broadcast solana-mainnet</code>
                </div>
            </section>

            <section class="docs-section" id="cosmos">
                <h2>Cosmos Ecosystem (Ed25519)</h2>
                <p>Cosmos chains support Ed25519 with Amino or Protobuf encoding.</p>

                <h3>Key Characteristics</h3>
                <ul>
                    <li>Same Ed25519 signatures as Solana</li>
                    <li>Bech32 addresses with chain-specific prefixes (cosmos1..., osmo1...)</li>
                    <li>SIGN_MODE_DIRECT for modern signing</li>
                </ul>

                <h3>Deriving Cosmos Address</h3>
                <div class="code-block">
                    <code>use sigil_frost::ed25519::Ed25519Frost;
use sha2::{Sha256, Digest};
use bech32::{ToBase32, Variant};

let (_, _, verifying_key) = Ed25519Frost::generate_2of2()?;

// Cosmos address = ripemd160(sha256(pubkey))
let sha256_hash = Sha256::digest(&verifying_key.data);
let ripemd_hash = ripemd160::Ripemd160::digest(&sha256_hash);

let address = bech32::encode("cosmos", ripemd_hash.to_base32(), Variant::Bech32)?;
println!("Cosmos address: {}", address);  // cosmos1...</code>
                </div>
            </section>

            <section class="docs-section" id="zcash">
                <h2>Zcash Shielded (Ristretto255)</h2>
                <p>Zcash shielded transactions use Ristretto255 for Sapling/Orchard.</p>

                <h3>Key Characteristics</h3>
                <ul>
                    <li>Privacy-preserving transactions (sender, receiver, amount hidden)</li>
                    <li>PCZT (Partially Created Zcash Transactions) for threshold signing</li>
                    <li>Viewing keys for audit without spending capability</li>
                    <li>Note commitments and nullifiers</li>
                </ul>

                <h3>Creating a Zcash Child Disk</h3>
                <div class="code-block">
                    <code>sigil ceremony create-child \
  --scheme ristretto255 \
  --presigs 500 \
  --label "zcash-shielded-001"</code>
                </div>

                <h3>PCZT Integration Workflow</h3>
                <div class="code-block">
                    <code>Standard Zcash Flow:
  1. Create transaction &rarr; 2. Sign &rarr; 3. Broadcast

PCZT + Sigil Flow:
  1. Create PCZT (partial tx)
  2. Extract signing data
  3. Sign with FROST (air-gapped)
  4. Insert signature into PCZT
  5. Finalize and broadcast</code>
                </div>

                <h3>Privacy Considerations</h3>
                <ul>
                    <li><strong>Viewing Keys:</strong> Generate viewing keys to audit without spending</li>
                    <li><strong>Diversified Addresses:</strong> Support multiple addresses from one key</li>
                    <li><strong>Turnstile:</strong> Value cannot cross pools without re-shielding</li>
                </ul>
            </section>

            <section class="docs-section" id="dkg">
                <h2>Distributed Key Generation (DKG)</h2>
                <p>Sigil supports two key generation modes:</p>

                <table class="docs-table">
                    <thead>
                        <tr>
                            <th>Mode</th>
                            <th>Trust Model</th>
                            <th>Setup Complexity</th>
                            <th>Use Case</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><strong>Trusted Dealer</strong></td>
                            <td>Mother sees full key during generation</td>
                            <td>Simple (one device)</td>
                            <td>Quick setup, air-gapped mother</td>
                        </tr>
                        <tr>
                            <td><strong>DKG</strong></td>
                            <td>Neither party sees full key</td>
                            <td>Interactive (QR codes)</td>
                            <td>Maximum security</td>
                        </tr>
                    </tbody>
                </table>

                <h3>DKG Ceremony Guide</h3>

                <h4>Prerequisites</h4>
                <ul>
                    <li><strong>Mother Device:</strong> Air-gapped, has camera + display</li>
                    <li><strong>Agent Device:</strong> Network-connected, has camera + display</li>
                    <li><strong>Communication:</strong> QR codes (offline-safe, auditable)</li>
                </ul>

                <h4>Step 1: Initialize Ceremonies</h4>
                <div class="code-block">
                    <code># On Mother Device:
sigil ceremony dkg-init --role mother --scheme taproot

# On Agent Device:
sigil ceremony dkg-init --role agent --scheme taproot</code>
                </div>

                <h4>Step 2: Exchange Round 1</h4>
                <ol>
                    <li>Mother displays QR &rarr; Agent scans</li>
                    <li>Agent displays QR &rarr; Mother scans</li>
                </ol>

                <h4>Step 3: Exchange Round 2</h4>
                <ol>
                    <li>Mother displays Round 2 QR &rarr; Agent scans</li>
                    <li>Agent displays Round 2 QR &rarr; Mother scans</li>
                </ol>

                <h4>Step 4: Finalize</h4>
                <p>Both devices compute their final key shares and the group public key.</p>

                <div class="callout callout-info">
                    <strong>Important:</strong> Neither device has ever seen the full private key. The key only exists as the sum of both shares.
                </div>

                <h3>When to Use DKG</h3>
                <p><strong>Use DKG when:</strong></p>
                <ul>
                    <li>Maximum security is required</li>
                    <li>Regulatory compliance demands proof that no single party held the full key</li>
                    <li>Multiple independent organizations are participating</li>
                    <li>Audit trail of key generation is important</li>
                </ul>

                <p><strong>Use Trusted Dealer when:</strong></p>
                <ul>
                    <li>Quick setup is needed</li>
                    <li>Mother device is already trusted</li>
                    <li>Simplicity is preferred</li>
                    <li>Recovery flexibility is important</li>
                </ul>
            </section>

            <section class="docs-section">
                <h2>Security Considerations</h2>

                <h3>Nonce Security</h3>
                <div class="callout callout-danger">
                    <strong>WARNING:</strong> Nonce reuse across two messages reveals the private key!
                    <div class="code-block" style="margin-top: var(--spacing-md); background: rgba(0,0,0,0.1);">
                        <code style="color: #991b1b;">s&#8321; = k + e&#8321;&middot;x  (message 1)
s&#8322; = k + e&#8322;&middot;x  (message 2)

x = (s&#8321; - s&#8322;) / (e&#8321; - e&#8322;)  (attacker recovers key)</code>
                    </div>
                </div>

                <p>Sigil prevents nonce reuse through:</p>
                <ol>
                    <li><strong>Single-use presignatures:</strong> Each nonce is generated once and consumed</li>
                    <li><strong>Status tracking:</strong> Cold share status byte (Fresh&rarr;Used&rarr;Void)</li>
                    <li><strong>Agent index tracking:</strong> Agent maintains authoritative used-index list</li>
                    <li><strong>Reconciliation:</strong> Mother device detects anomalies during reconciliation</li>
                </ol>

                <h3>Cross-Chain Considerations</h3>
                <p>When using the same key for multiple chains:</p>
                <ol>
                    <li><strong>Address Derivation:</strong> Different chains derive addresses differently</li>
                    <li><strong>Replay Protection:</strong> Sign chain-specific data (chain ID, genesis hash)</li>
                    <li><strong>Presig Allocation:</strong> Reserve presigs per chain to prevent exhaustion</li>
                </ol>

                <div class="code-block">
                    <code>// Recommended: Use different child disks per ecosystem
let btc_disk = create_child(Taproot, 1000, "btc-001")?;
let sol_disk = create_child(Ed25519, 5000, "sol-001")?;
let zec_disk = create_child(Ristretto255, 500, "zec-001")?;</code>
                </div>
            </section>

            <div class="docs-footer">
                <div class="docs-nav-footer">
                    <a href="crypto-spec.html" class="prev">&larr; Cryptographic Specification</a>
                    <a href="threat-model.html" class="next">Threat Model &rarr;</a>
                </div>
            </div>
        </article>
    </main>

    <!-- Footer -->
    <footer class="footer">
        <div class="container">
            <div class="footer-bottom">
                <p>&copy; 2026 ChipprBots. All rights reserved.</p>
                <p class="footer-warning">This software involves bleeding-edge cryptography and is unaudited. Read security documentation before use.</p>
            </div>
        </div>
    </footer>

    <script src="../js/main.js"></script>
</body>
</html>
